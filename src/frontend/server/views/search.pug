extends layout

block scripts
    link(rel="stylesheet",
        href="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.css",
        integrity="sha384-q94+BZtLrkL1/ohfjR8c6L+A6qzNH9R2hBLwyoAfu3i/WCvQjzL2RQJ3uNHDISdU",
        crossorigin="anonymous")
    script(
        src="https://code.jquery.com/jquery-3.5.1.min.js",
        integrity="sha384-ZvpUoO/+PpLXR1lu4jmpXWu80pZlYUAfxl5NsBMWOEPSjUn/6Z/hRTt8+pR6L4N2",
        crossorigin="anonymous")
    script(
        src="https://unpkg.com/@chrisoakman/chessboardjs@1.0.0/dist/chessboard-1.0.0.min.js",
        integrity="sha384-8Vi8VHwn3vjQ9eUHUxex3JSN/NFqUg3QbPyX8kWyb93+8AC/pPWTzj+nHtbC5bxD",
        crossorigin="anonymous")
    script(type="module", src="/javascripts/search.js")

block content
    .search-results-container
        .title-item
            #title CheSSE
            #subtitle Chess Similarity Search Engine
        .search-board-item
            #query-board
            script.
                var side_board_config = {
                    pieceTheme: 'images/chesspieces/default/{piece}.png',
                    position: "#{queryFenEncoding}",
                    showNotation: false
                };
                Chessboard("query-board", side_board_config);
        .search-results-item
            - var i = 0
            each position in positions
                - i++
                - var resultBoardId = "result-board-" + i
                .search-result
                    a(href=`/games?position.fen=${position.fen_encoding}`)
                        div(id=resultBoardId).result-board
                    .result-stats
                        p #{position.stats.nrGames} games found
                        p Rating: #{position.stats.rating.min} min, #{position.stats.rating.avg} average, #{position.stats.rating.max} max
                        p Win rate: #{position.stats.result.whiteWinPct}% white, #{position.stats.result.drawPct}% draw, #{position.stats.result.blackWinPct}% black
                script.
                    var board_config = {
                        pieceTheme: 'images/chesspieces/default/{piece}.png',
                        position: "#{position.fenEncoding}",
                        showNotation: false
                    };
                    Chessboard("#{resultBoardId}", board_config);
