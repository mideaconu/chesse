import chess
import pytest

from src.encoding import activity_encoding


@pytest.mark.parametrize(
    "board, expected_encoding",
    [
        pytest.param(
            chess.Board(fen="rr4k1/2qbpp2/1n1p1b1p/p2P2p1/2pP1PP1/Q1N4P/PPP1RBB1/2K1R3 w - -"),
            {
                "Be3|0.89",
                "Be4|0.78",
                "Bf1|0.89",
                "Bf3|0.89",
                "Bg1|0.89",
                "Bg3|0.89",
                "Bh1|0.89",
                "Bh4|0.78",
                "Kb1|0.89",
                "Kd1|0.89",
                "Kd2|0.89",
                "Na4|0.78",
                "Nb1|0.78",
                "Nb5|0.78",
                "Nd1|0.78",
                "Ne4|0.78",
                "Pb3|0.89",
                "Pb4|0.78",
                "Pf5|0.89",
                "Pg5|0.89",
                "Ph4|0.89",
                "Qa4|0.89",
                "Qa5|0.78",
                "Qb3|0.89",
                "Qb4|0.89",
                "Qc5|0.78",
                "Qd6|0.67",
                "Rd1|0.89",
                "Rd2|0.89",
                "Re3|0.89",
                "Re4|0.78",
                "Re5|0.67",
                "Re6|0.56",
                "Re7|0.45",
                "Rf1|0.89",
                "Rg1|0.78",
                "Rh1|0.67",
                "ba4|0.67",
                "bb5|0.78",
                "bc6|0.89",
                "bc8|0.89",
                "bd4|0.78",
                "be5|0.89",
                "be6|0.89",
                "be8|0.89",
                "bf5|0.78",
                "bg4|0.67",
                "bg7|0.89",
                "bh8|0.78",
                "kf8|0.89",
                "kg7|0.89",
                "kh7|0.89",
                "kh8|0.89",
                "na4|0.78",
                "nc8|0.78",
                "nd5|0.78",
                "pa4|0.89",
                "pe5|0.78",
                "pe6|0.89",
                "pf4|0.89",
                "ph5|0.89",
                "qa7|0.78",
                "qb7|0.89",
                "qc5|0.78",
                "qc6|0.89",
                "qc8|0.89",
                "qd8|0.89",
                "ra6|0.78",
                "ra7|0.89",
                "rb7|0.89",
                "rc8|0.89",
                "rd8|0.78",
                "re8|0.67",
                "rf8|0.56",
            },
        ),
    ],
)
def test_get_activity_encoding(board, expected_encoding):
    actual_encoding = activity_encoding.get_activity_encoding(board).split()

    assert len(set(actual_encoding)) == len(actual_encoding)
    assert expected_encoding == set(actual_encoding)
